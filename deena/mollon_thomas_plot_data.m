%% Lambda max data 
data_longest = [0.02899207817042876, 0.1515318529466572;
0.06156668005674332, 0.15155872968088682;
0.09414157810541857, 0.15164202534482163;
0.12671677231645445, 0.1517817399384616;
0.15929226268985103, 0.15197787346180677;
0.19186790114442787, 0.1522022164500045;
0.22444650122261128, 0.15299074873525406;
0.2570200665406636, 0.15282015921551562;
0.28959526075169956, 0.1529598738091556;
0.32216719717676817, 0.15247898017603861;
0.35474253946898443, 0.15264690423453117;
0.3873178817612006, 0.15281482829302379;
0.41989322405341684, 0.15298275235151637;
0.4524687144268134, 0.1531788858748615;
0.4850445009625706, 0.15343143832791187;
0.5176179181994425, 0.15323263934332076;
0.5501937047351997, 0.15348519179637113;
0.5827687508650552, 0.1535966969251585;
0.6153436489137307, 0.15367999258909332;
0.6479191392871271, 0.1538761261124385;
0.680493889254622, 0.15393121231152074;
0.7130687873032973, 0.15401450797545552;
0.745643981514333, 0.15415422256909553;
0.7782193238065493, 0.1543221466275881;
0.8107942218552244, 0.1544054422915229;
0.8433701564721621, 0.15468620420942586;
0.8759450545208374, 0.15476949987336064;
0.9085196564071518, 0.15479637660759027;
0.9410942582934665, 0.1548232533418199;
0.9736697486668631, 0.15501938686516506;
0.9958804449043428, 0.15517875923549368;]; 

longFitParams = polyfit(data_longest(:,1), data_longest(:,2), 1); 

data_shortest = [0.01837402819585504, 0.3147987675729777;
0.04314073517683842, 0.30826405614596386;
0.06679572269650519, 0.3014957003816129;
0.09045172827428671, 0.2949212846881235;
0.11410691940557643, 0.2881917169379448;
0.13776333220660392, 0.2816948772728;
0.1614191341727625, 0.2750816735651383;
0.18507473252729806, 0.2684296818433043;
0.20873053449345674, 0.26181647813564257;
0.2323865400712382, 0.25524206244215314;
0.2560421384257738, 0.24859007072031908;
0.27969875483842416, 0.2421320190693466;
0.3048323699639666, 0.23497700483301023;
0.3299659850895092, 0.22782199059667385;
0.35362219427891367, 0.22128636291735676;
0.37727718179858044, 0.21451800715300579;
0.400933187376362, 0.20794359145951638;
0.4245881748960288, 0.2011752356951654;
0.44824418047381015, 0.194600820001676;
0.47190018605159173, 0.18802640430818657;
0.4955551735712585, 0.18125804854383562;
0.519210975537417, 0.17464484483617387;
0.5428661666687069, 0.1679152770859952;
0.5665225794697344, 0.16141843742085044;
0.591657981852856, 0.1546038957533599;
0.6167918458370487, 0.1474962890899008;
0.64045003684625, 0.14133819808186085;
0.6641059066829496, 0.13473792371225657;
0.6877589724967272, 0.12760348297605079;
0.7158510500482151, 0.11990512609968468;
0.7439493404866531, 0.113390324187366;
0.7690791568010589, 0.10551163642947203;
0.7937195623072841, 0.09842192884363565;
0.8223088663563927, 0.09142348063359235;
0.8489233488156631, 0.08430847608116598;
0.8740615791379927, 0.07803265683273536;
0.899197863838147, 0.07138619655999145;
0.9243295559650284, 0.06386485107869444;
0.9465061388820255, 0.05752563589708898;
0.9701582941532438, 0.05021773680332531;
0.9938175682900945, 0.044265981612475025];

shortFitParams = polyfit(data_shortest(:,1), data_shortest(:,2), 1); 

%% Optical density data 
odFitParams = zeros(5, 2); 

% Optical density of 0.05, or -83.33%
data_5 = [0.031327438583960615, 0.15770117424892546
0.06375133973315256, 0.1567268263116374
0.096172328555894, 0.15570739070701778
0.12859622970508594, 0.15473304276972974
0.1610192987610063, 0.1537458126417755
0.18460717328768805, 0.15314333066663585
0.32018501207507283, 0.14886720471878945
0.3526022564780921, 0.14778979925617208
0.38502490948737667, 0.14679612803288478
0.41744714645002545, 0.14579601571426443
0.4498710475992175, 0.14482166777697636
0.48229328456186626, 0.14382155545835598
0.514715521524515, 0.1428214431397356
0.5471399774025547, 0.14185568332955834
0.5795599954498126, 0.14082121850249485
0.6119820243891435, 0.13981788563620795
0.6451449630457095, 0.13885437964311154
0.6768271223843948, 0.13782732264196682
0.709248527253772, 0.1368143281326803
0.7416699321231492, 0.13580133362339375
0.7740925851324337, 0.13480766240010644
0.8065135739551752, 0.13378822679548685
0.8389370590577314, 0.1328074377628657
0.8713601281136518, 0.13182020763491148
0.9037807008897574, 0.1307943309349588
0.9362021057591348, 0.12978133642567224
0.9686247587684194, 0.12878766520238494
0.9922046733713075, 0.1280619503403822]; 
odFitParams(1,:) = polyfit(data_5(:,1), data_5(:,2), 1);

% Optical density of 0.2, or -33.33% 
data_20 = [0.29491266136245664, 0.15082484483328285;
0.3261961925511709, 0.15048477392981813;
0.358659202084127, 0.15011588895383965;
0.3911234597569906, 0.14976632726386038;
0.42358896556976144, 0.14943608885988038;
0.4560536392892608, 0.14909296826523422;
0.4885170648688527, 0.1487305243845888;
0.5209817385883521, 0.14838740378994264;
0.5534459962612155, 0.1480378420999634;
0.5859098378874433, 0.14768183931465106;
0.6183745116069426, 0.14733871872000492;
0.6508404334663492, 0.147014921411358;
0.683304275092577, 0.14665891862604566;
0.7157681167188048, 0.14630291584073335;
0.7482336225315757, 0.14597267743675335;
0.7806970481111676, 0.14561023355610792;
0.813159641597488, 0.14523490748479637;
0.8456284757833452, 0.14495619784348102;
0.8780927334562088, 0.14460663615350175;
0.9105565750824365, 0.14425063336818944;
0.9430204167086642, 0.1438946305828771;
0.9754855064747994, 0.143557951083564;
0.996145966361468, 0.14335697305317235]; 
odFitParams(2,:) = polyfit(data_20(:,1), data_20(:,2), 1); 

% Optical density of 0.35, or 16.67% 
data_35 = [0.2576617143366741, 0.15251103415879189;
0.28794625167880716, 0.1527078400792983;
0.32045544238833595, 0.15305391668529175;
0.35296130472477844, 0.15334846452862055;
0.3854692472943999, 0.15367521784861476;
0.4179771898640213, 0.15400197116860898;
0.4504830522004637, 0.15429651901193778;
0.4829914108167209, 0.15462971342726506;
0.515500185479614, 0.15496934893792544;
0.5480075733203876, 0.15528751413080885;
0.5805131582924062, 0.15557776791058228;
0.6130198527221203, 0.15588519794457725;
0.6455286273850133, 0.15622483345523763;
0.6780369860012705, 0.1565580278705649;
0.7105440964776204, 0.15687189899989296;
0.7430512069539702, 0.157185770129221;
0.7755599816168632, 0.15752540563988138;
0.8080662599999414, 0.15782639457854325;
0.8405729544296555, 0.15813382461253822;
0.8730817290925486, 0.15847346012319857;
0.9055909198020775, 0.15881953672919202;
0.9380971981851556, 0.1591205256678539;
0.9706047247081413, 0.15944083789251504;
0.9942485440742868, 0.15970447527367343];
odFitParams(3,:) = polyfit(data_35(:,1), data_35(:,2), 1); 
 
% Optical density of 0.5, or 66.67% 
data_50 = [0.23780015066710347, 0.15364956672442218;
0.27035080735799927, 0.154637605831946;
0.30290035459119974, 0.15560846868524825;
0.3354528141508506, 0.15662441920588205;
0.3680036095239584, 0.15761460534518357;
0.4005552369903377, 0.15861767367515123;
0.4331076965499886, 0.15963362419578503;
0.4656593240163679, 0.1606366925257527;
0.4982109514827472, 0.16163976085572035;
0.5307634110423981, 0.16265571137635418;
0.5633172574241683, 0.16369313221476495;
0.5958683301616998, 0.1646876124176218;
0.628418293441536, 0.16566491636625716;
0.6609715850944584, 0.16669374907755713;
0.6935236286074735, 0.1677032585028579;
0.7260765042137602, 0.1687256501188248;
0.7586285477267753, 0.16973515954412552;
0.7911810072864263, 0.17075111006475935;
0.8237326347528056, 0.171754178394727;
0.8562834301259132, 0.1727443645340285;
0.8888354736389283, 0.17375387395932923;
0.9213871011053076, 0.1747569422892969;
0.9539378964784155, 0.1757471284285984;
0.9864903560380662, 0.1767630789492322];
odFitParams(4,:) = polyfit(data_50(:,1), data_50(:,2), 1); 

% Optical density of 0.65, or 116.67% 
data_65 = [0.030492849032566965, 0.14478033701076598;
0.21422819642318008, 0.15449852121046456;
0.24385062443658173, 0.15587546160579738;
0.2720052306734373, 0.15738945532884435;
0.3016387625092741, 0.1589383014018445;
0.33127183669381155, 0.16048006226997824;
0.36090491087834903, 0.16202182313811198;
0.39025454635814427, 0.1637477566186506;
0.3772061450609854, 0.16291690822794705;
0.4098000706020033, 0.16457482125011122;
0.4498064216884582, 0.1666825317668452;
0.47944178412949245, 0.1682597186593109;
0.5090757736166287, 0.16981564993717743;
0.538708847801166, 0.1713574108053112;
0.5683419219857035, 0.17289917167344493;
0.5979763691241391, 0.17446218815617784;
0.6276094433086765, 0.1760039490243116;
0.6572425174932139, 0.17754570989244536;
0.6853946320729952, 0.17902112861121977;
0.713546136451044, 0.18048710039017235;
0.7431792106355815, 0.18202886125830608;
0.7728127424714182, 0.18357770733130624;
0.8024458166559557, 0.18511946819944;
0.832077517886595, 0.1866399734529746;
0.8617083038146357, 0.1881463082967764;
0.8913441239069693, 0.18973058039410848;
0.9209767404402074, 0.19126525605737585;
0.9506102722760443, 0.19281410213037598;
0.980245177065779, 0.1943842038179753;
0.9995036013945009, 0.19533875942290965];
odFitParams(5,:) = polyfit(data_65(:,1), data_65(:,2), 1); 

save('mollon_thomas_odFitParams.mat', 'odFitParams'); 